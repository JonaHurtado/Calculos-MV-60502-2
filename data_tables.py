
# data_tables.py
# This file contains hardcoded data tables based on IEC 60502-2.

import pandas as pd

# --- General Parameters ---
MAX_TEMPERATURES = {
    "EPR": 90,
    "HEPR": 90,
    "XLPE": 90
}

VALID_SECTIONS = [10, 16, 25, 35, 50, 70, 95, 120, 150, 185, 240, 300, 400]

# --- Ampacity Tables (Base Iz) ---
# CORRECTED Complete ampacity database from IEC 60502-2 Tables B.2 to B.9
# Structure: (insulation, conductor, core_type, installation, armoring, layout) -> {data, source}
# Where:
#   insulation: "XLPE", "EPR", "HEPR" (HEPR maps to EPR values)
#   conductor: "Cu", "Al"
#   core_type: "Single Core", "Three Core"
#   installation: "Direct", "Ducts", "Air"
#   armoring: "Unarmoured", "Armoured"
#   layout: "Trefoil", "Flat Spaced", "Flat Touching", "N/A" (for Three Core)

AMPACITY_DB = {
    # ============================================================================
    # TABLE B.2 - XLPE COPPER SINGLE CORE  
    # ============================================================================
    ("XLPE", "Cu", "Single Core", "Direct", "Unarmoured", "Trefoil"): {
        "source": "Table B.2 - XLPE Cu SC Trefoil Direct Unarm",
        "data": {16: 109, 25: 140, 35: 166, 50: 196, 70: 239, 95: 285, 120: 323,
                 150: 361, 185: 406, 240: 469, 300: 526, 400: 590}
    },
    ("XLPE", "Cu", "Single Core", "Direct", "Unarmoured", "Flat Spaced"): {
        "source": "Table B.2 - XLPE Cu SC Flat Spaced Direct Unarm",
        "data": {16: 113, 25: 144, 35: 172, 50: 203, 70: 246, 95: 293, 120: 332,
                 150: 366, 185: 410, 240: 470, 300: 524, 400: 572}
    },
    
    ("XLPE", "Cu", "Single Core", "Ducts", "Unarmoured", "Trefoil"): {
        "source": "Table B.2 - XLPE Cu SC Trefoil Ducts Unarm",
        "data": {16: 103, 25: 132, 35: 157, 50: 186, 70: 227, 95: 271, 120: 308,
                 150: 343, 185: 387, 240: 447, 300: 504, 400: 564}
    },
    ("XLPE", "Cu", "Single Core", "Ducts", "Unarmoured", "Flat Touching"): {
        "source": "Table B.2 - XLPE Cu SC Flat Touch Ducts Unarm",
        "data": {16: 104, 25: 133, 35: 159, 50: 188, 70: 229, 95: 274, 120: 311,
                 150: 347, 185: 391, 240: 453, 300: 510, 400: 571}
    },
    
    ("XLPE", "Cu", "Single Core", "Air", "Unarmoured", "Trefoil"): {
        "source": "Table B.2 - XLPE Cu SC Trefoil Air Unarm",
        "data": {16: 125, 25: 163, 35: 198, 50: 238, 70: 296, 95: 361, 120: 417,
                 150: 473, 185: 543, 240: 641, 300: 735, 400: 845}
    },
    ("XLPE", "Cu", "Single Core", "Air", "Unarmoured", "Flat Touching"): {
        "source": "Table B.2 - XLPE Cu SC Flat Touch Air Unarm",
        "data": {16: 128, 25: 167, 35: 203, 50: 243, 70: 303, 95: 369, 120: 426,
                 150: 481, 185: 550, 240: 647, 300: 739, 400: 837}
    },
    ("XLPE", "Cu", "Single Core", "Air", "Unarmoured", "Flat Spaced"): {
        "source": "Table B.2 - XLPE Cu SC Flat Spaced Air Unarm",
        "data": {16: 150, 25: 196, 35: 238, 50: 286, 70: 356, 95: 434, 120: 500,
                 150: 559, 185: 637, 240: 745, 300: 846, 400: 938}
    },

    # ============================================================================
    # TABLE B.3 - XLPE ALUMINIUM SINGLE CORE
    # ============================================================================
    ("XLPE", "Al", "Single Core", "Direct", "Unarmoured", "Trefoil"): {
        "source": "Table B.3 - XLPE Al SC Trefoil Direct Unarm",
        "data": {16: 84, 25: 108, 35: 129, 50: 152, 70: 186, 95: 221, 120: 252,
                 150: 281, 185: 317, 240: 367, 300: 414, 400: 470}
    },
    ("XLPE", "Al", "Single Core", "Direct", "Unarmoured", "Flat Spaced"): {
        "source": "Table B.3 - XLPE Al SC Flat Spaced Direct Unarm",
        "data": {16: 88, 25: 112, 35: 134, 50: 157, 70: 192, 95: 229, 120: 260,
                 150: 288, 185: 324, 240: 373, 300: 419, 400: 466}
    },
    
    ("XLPE", "Al", "Single Core", "Ducts", "Unarmoured", "Trefoil"): {
        "source": "Table B.3 - XLPE Al SC Trefoil Ducts Unarm",
        "data": {16: 80, 25: 102, 35: 122, 50: 144, 70: 176, 95: 210, 120: 240,
                 150: 267, 185: 303, 240: 351, 300: 397, 400: 451}
    },
    ("XLPE", "Al", "Single Core", "Ducts", "Unarmoured", "Flat Touching"): {
        "source": "Table B.3 - XLPE Al SC Flat Touch Ducts Unarm",
        "data": {16: 81, 25: 103, 35: 123, 50: 146, 70: 178, 95: 213, 120: 242,
                 150: 271, 185: 307, 240: 356, 300: 402, 400: 457}
    },
    
    ("XLPE", "Al", "Single Core", "Air", "Unarmoured", "Trefoil"): {
        "source": "Table B.3 - XLPE Al SC Trefoil Air Unarm",
        "data": {16: 97, 25: 127, 35: 154, 50: 184, 70: 230, 95: 280, 120: 324,
                 150: 368, 185: 424, 240: 502, 300: 577, 400: 673}
    },
    ("XLPE", "Al", "Single Core", "Air", "Unarmoured", "Flat Touching"): {
        "source": "Table B.3 - XLPE Al SC Flat Touch Air Unarm",
        "data": {16: 99, 25: 130, 35: 157, 50: 189, 70: 236, 95: 287, 120: 332,
                 150: 376, 185: 432, 240: 511, 300: 586, 400: 676}
    },
    ("XLPE", "Al", "Single Core", "Air", "Unarmoured", "Flat Spaced"): {
        "source": "Table B.3 - XLPE Al SC Flat Spaced Air Unarm",
        "data": {16: 116, 25: 153, 35: 185, 50: 222, 70: 278, 95: 338, 120: 391,
                 150: 440, 185: 504, 240: 593, 300: 677, 400: 769}
    },

    # ============================================================================
    # TABLE B.4 - EPR COPPER SINGLE CORE
    # ============================================================================
    ("EPR", "Cu", "Single Core", "Direct", "Unarmoured", "Trefoil"): {
        "source": "Table B.4 - EPR Cu SC Trefoil Direct Unarm",
        "data": {16: 106, 25: 136, 35: 162, 50: 192, 70: 234, 95: 280, 120: 319,
                 150: 357, 185: 403, 240: 467, 300: 526, 400: 597}
    },
    ("EPR", "Cu", "Single Core", "Direct", "Unarmoured", "Flat Spaced"): {
        "source": "Table B.4 - EPR Cu SC Flat Spaced Direct Unarm",
        "data": {16: 109, 25: 140, 35: 167, 50: 198, 70: 242, 95: 289, 120: 329,
                 150: 369, 185: 417, 240: 484, 300: 545, 400: 618}
    },
    
    ("EPR", "Cu", "Single Core", "Ducts", "Unarmoured", "Trefoil"): {
        "source": "Table B.4 - EPR Cu SC Trefoil Ducts Unarm",
        "data": {16: 99, 25: 128, 35: 153, 50: 181, 70: 222, 95: 266, 120: 303,
                 150: 341, 185: 386, 240: 449, 300: 509, 400: 580}
    },
    ("EPR", "Cu", "Single Core", "Ducts", "Unarmoured", "Flat Touching"): {
        "source": "Table B.4 - EPR Cu SC Flat Touch Ducts Unarm",
        "data": {16: 100, 25: 129, 35: 154, 50: 183, 70: 224, 95: 269, 120: 306,
                 150: 344, 185: 390, 240: 454, 300: 515, 400: 588}
    },
    
    ("EPR", "Cu", "Single Core", "Air", "Unarmoured", "Trefoil"): {
        "source": "Table B.4 - EPR Cu SC Trefoil Air Unarm",
        "data": {16: 116, 25: 153, 35: 186, 50: 224, 70: 280, 95: 343, 120: 398,
                 150: 454, 185: 522, 240: 619, 300: 712, 400: 825}
    },
    ("EPR", "Cu", "Single Core", "Air", "Unarmoured", "Flat Touching"): {
        "source": "Table B.4 - EPR Cu SC Flat Touch Air Unarm",
        "data": {16: 119, 25: 156, 35: 190, 50: 229, 70: 287, 95: 352, 120: 407,
                 150: 465, 185: 534, 240: 634, 300: 728, 400: 843}
    },
    ("EPR", "Cu", "Single Core", "Air", "Unarmoured", "Flat Spaced"): {
        "source": "Table B.4 - EPR Cu SC Flat Spaced Air Unarm",
        "data": {16: 138, 25: 181, 35: 221, 50: 266, 70: 334, 95: 409, 120: 474,
                 150: 540, 185: 621, 240: 736, 300: 843, 400: 977}
    },

    # ============================================================================
    # TABLE B.5 - EPR ALUMINIUM SINGLE CORE
    # ============================================================================
    ("EPR", "Al", "Single Core", "Direct", "Unarmoured", "Trefoil"): {
        "source": "Table B.5 - EPR Al SC Trefoil Direct Unarm",
        "data": {16: 82, 25: 105, 35: 126, 50: 149, 70: 182, 95: 217, 120: 247,
                 150: 277, 185: 314, 240: 364, 300: 411, 400: 471}
    },
    ("EPR", "Al", "Single Core", "Direct", "Unarmoured", "Flat Spaced"): {
        "source": "Table B.5 - EPR Al SC Flat Spaced Direct Unarm",
        "data": {16: 84, 25: 109, 35: 130, 50: 153, 70: 188, 95: 224, 120: 256,
                 150: 287, 185: 325, 240: 377, 300: 426, 400: 487}
    },
    
    ("EPR", "Al", "Single Core", "Ducts", "Unarmoured", "Trefoil"): {
        "source": "Table B.5 - EPR Al SC Trefoil Ducts Unarm",
        "data": {16: 77, 25: 99, 35: 118, 50: 140, 70: 172, 95: 206, 120: 235,
                 150: 264, 185: 300, 240: 350, 300: 397, 400: 456}
    },
    ("EPR", "Al", "Single Core", "Ducts", "Unarmoured", "Flat Touching"): {
        "source": "Table B.5 - EPR Al SC Flat Touch Ducts Unarm",
        "data": {16: 78, 25: 100, 35: 120, 50: 142, 70: 174, 95: 208, 120: 238,
                 150: 267, 185: 303, 240: 354, 300: 401, 400: 462}
    },
    
    ("EPR", "Al", "Single Core", "Air", "Unarmoured", "Trefoil"): {
        "source": "Table B.5 - EPR Al SC Trefoil Air Unarm",
        "data": {16: 90, 25: 119, 35: 144, 50: 174, 70: 218, 95: 266, 120: 309,
                 150: 352, 185: 406, 240: 483, 300: 556, 400: 651}
    },
    ("EPR", "Al", "Single Core", "Air", "Unarmoured", "Flat Touching"): {
        "source": "Table B.5 - EPR Al SC Flat Touch Air Unarm",
        "data": {16: 92, 25: 121, 35: 147, 50: 178, 70: 223, 95: 273, 120: 317,
                 150: 361, 185: 417, 240: 495, 300: 570, 400: 667}
    },
    ("EPR", "Al", "Single Core", "Air", "Unarmoured", "Flat Spaced"): {
        "source": "Table B.5 - EPR Al SC Flat Spaced Air Unarm",
        "data": {16: 107, 25: 141, 35: 171, 50: 207, 70: 259, 95: 317, 120: 368,
                 150: 419, 185: 484, 240: 575, 300: 659, 400: 770}
    },

    # ============================================================================
    # TABLE B.6 - XLPE COPPER THREE CORE (No layout distinction)
    # ============================================================================
    ("XLPE", "Cu", "Three Core", "Direct", "Unarmoured", "N/A"): {
        "source": "Table B.6 - XLPE Cu TC Direct Unarm",
        "data": {16: 101, 25: 129, 35: 153, 50: 181, 70: 221, 95: 262, 120: 298,
                 150: 334, 185: 377, 240: 434, 300: 489, 400: 553}
    },
    ("XLPE", "Cu", "Three Core", "Direct", "Armoured", "N/A"): {
        "source": "Table B.6 - XLPE Cu TC Direct Arm",
        "data": {16: 101, 25: 129, 35: 154, 50: 181, 70: 220, 95: 263, 120: 298,
                 150: 332, 185: 374, 240: 431, 300: 482, 400: 541}
    },
    ("XLPE", "Cu", "Three Core", "Ducts", "Unarmoured", "N/A"): {
        "source": "Table B.6 - XLPE Cu TC Ducts Unarm",
        "data": {16: 87, 25: 112, 35: 133, 50: 158, 70: 193, 95: 231, 120: 264,
                 150: 297, 185: 336, 240: 390, 300: 441, 400: 501}
    },
    ("XLPE", "Cu", "Three Core", "Ducts", "Armoured", "N/A"): {
        "source": "Table B.6 - XLPE Cu TC Ducts Arm",
        "data": {16: 88, 25: 112, 35: 134, 50: 158, 70: 194, 95: 232, 120: 264,
                 150: 296, 185: 335, 240: 387, 300: 435, 400: 492}
    },
    ("XLPE", "Cu", "Three Core", "Air", "Unarmoured", "N/A"): {
        "source": "Table B.6 - XLPE Cu TC Air Unarm",
        "data": {16: 109, 25: 142, 35: 170, 50: 204, 70: 253, 95: 304, 120: 351,
                 150: 398, 185: 455, 240: 531, 300: 606, 400: 696}
    },
    ("XLPE", "Cu", "Three Core", "Air", "Armoured", "N/A"): {
        "source": "Table B.6 - XLPE Cu TC Air Arm",
        "data": {16: 110, 25: 143, 35: 172, 50: 205, 70: 253, 95: 307, 120: 352,
                 150: 397, 185: 453, 240: 529, 300: 599, 400: 683}
    },

    # ============================================================================
    # TABLE B.7 - XLPE ALUMINIUM THREE CORE (No layout distinction)
    # ============================================================================
    ("XLPE", "Al", "Three Core", "Direct", "Unarmoured", "N/A"): {
        "source": "Table B.7 - XLPE Al TC Direct Unarm",
        "data": {16: 78, 25: 100, 35: 119, 50: 140, 70: 171, 95: 203, 120: 232,
                 150: 260, 185: 294, 240: 340, 300: 384, 400: 438}
    },
    ("XLPE", "Al", "Three Core", "Direct", "Armoured", "N/A"): {
        "source": "Table B.7 - XLPE Al TC Direct Arm",
        "data": {16: 78, 25: 100, 35: 119, 50: 140, 70: 171, 95: 204, 120: 232,
                 150: 259, 185: 293, 240: 338, 300: 380, 400: 432}
    },
    ("XLPE", "Al", "Three Core", "Ducts", "Unarmoured", "N/A"): {
        "source": "Table B.7 - XLPE Al TC Ducts Unarm",
        "data": {16: 67, 25: 87, 35: 103, 50: 122, 70: 150, 95: 179, 120: 205,
                 150: 231, 185: 262, 240: 305, 300: 346, 400: 398}
    },
    ("XLPE", "Al", "Three Core", "Ducts", "Armoured", "N/A"): {
        "source": "Table B.7 - XLPE Al TC Ducts Arm",
        "data": {16: 68, 25: 87, 35: 104, 50: 123, 70: 150, 95: 180, 120: 206,
                 150: 231, 185: 262, 240: 304, 300: 343, 400: 393}
    },
    ("XLPE", "Al", "Three Core", "Air", "Unarmoured", "N/A"): {
        "source": "Table B.7 - XLPE Al TC Air Unarm",
        "data": {16: 84, 25: 110, 35: 132, 50: 158, 70: 196, 95: 236, 120: 273,
                 150: 309, 185: 355, 240: 415, 300: 475, 400: 552}
    },
    ("XLPE", "Al", "Three Core", "Air", "Armoured", "N/A"): {
        "source": "Table B.7 - XLPE Al TC Air Arm",
        "data": {16: 85, 25: 111, 35: 133, 50: 159, 70: 196, 95: 238, 120: 274,
                 150: 309, 185: 354, 240: 415, 300: 472, 400: 545}
    },

    # ============================================================================
    # TABLE B.8 - EPR COPPER THREE CORE (No layout distinction)
    # ============================================================================
    ("EPR", "Cu", "Three Core", "Direct", "Unarmoured", "N/A"): {
        "source": "Table B.8 - EPR Cu TC Direct Unarm",
        "data": {16: 98, 25: 125, 35: 150, 50: 176, 70: 216, 95: 258, 120: 292,
                 150: 328, 185: 371, 240: 429, 300: 482, 400: 545}
    },
    ("EPR", "Cu", "Three Core", "Direct", "Armoured", "N/A"): {
        "source": "Table B.8 - EPR Cu TC Direct Arm",
        "data": {16: 98, 25: 125, 35: 150, 50: 177, 70: 216, 95: 257, 120: 292,
                 150: 327, 185: 368, 240: 424, 300: 475, 400: 534}
    },
    ("EPR", "Cu", "Three Core", "Ducts", "Unarmoured", "N/A"): {
        "source": "Table B.8 - EPR Cu TC Ducts Unarm",
        "data": {16: 84, 25: 109, 35: 130, 50: 154, 70: 189, 95: 227, 120: 258,
                 150: 291, 185: 330, 240: 384, 300: 434, 400: 494}
    },
    ("EPR", "Cu", "Three Core", "Ducts", "Armoured", "N/A"): {
        "source": "Table B.8 - EPR Cu TC Ducts Arm",
        "data": {16: 85, 25: 109, 35: 131, 50: 155, 70: 190, 95: 227, 120: 259,
                 150: 291, 185: 328, 240: 381, 300: 429, 400: 485}
    },
    ("EPR", "Cu", "Three Core", "Air", "Unarmoured", "N/A"): {
        "source": "Table B.8 - EPR Cu TC Air Unarm",
        "data": {16: 104, 25: 135, 35: 164, 50: 195, 70: 243, 95: 296, 120: 339,
                 150: 385, 185: 441, 240: 519, 300: 590, 400: 678}
    },
    ("EPR", "Cu", "Three Core", "Air", "Armoured", "N/A"): {
        "source": "Table B.8 - EPR Cu TC Air Arm",
        "data": {16: 104, 25: 136, 35: 164, 50: 197, 70: 244, 95: 296, 120: 339,
                 150: 385, 185: 439, 240: 513, 300: 583, 400: 666}
    },

    # ============================================================================
    # TABLE B.9 - EPR ALUMINIUM THREE CORE (No layout distinction)
    # ============================================================================
    ("EPR", "Al", "Three Core", "Direct", "Unarmoured", "N/A"): {
        "source": "Table B.9 - EPR Al TC Direct Unarm",
        "data": {16: 76, 25: 97, 35: 116, 50: 137, 70: 167, 95: 200, 120: 227,
                 150: 255, 185: 289, 240: 335, 300: 378, 400: 432}
    },
    ("EPR", "Al", "Three Core", "Direct", "Armoured", "N/A"): {
        "source": "Table B.9 - EPR Al TC Direct Arm",
        "data": {16: 76, 25: 97, 35: 116, 50: 137, 70: 168, 95: 200, 120: 227,
                 150: 254, 185: 288, 240: 332, 300: 374, 400: 426}
    },
    ("EPR", "Al", "Three Core", "Ducts", "Unarmoured", "N/A"): {
        "source": "Table B.9 - EPR Al TC Ducts Unarm",
        "data": {16: 65, 25: 84, 35: 101, 50: 119, 70: 147, 95: 176, 120: 201,
                 150: 226, 185: 257, 240: 300, 300: 340, 400: 392}
    },
    ("EPR", "Al", "Three Core", "Ducts", "Armoured", "N/A"): {
        "source": "Table B.9 - EPR Al TC Ducts Arm",
        "data": {16: 66, 25: 85, 35: 101, 50: 120, 70: 147, 95: 176, 120: 201,
                 150: 226, 185: 257, 240: 299, 300: 338, 400: 387}
    },
    ("EPR", "Al", "Three Core", "Air", "Unarmoured", "N/A"): {
        "source": "Table B.9 - EPR Al TC Air Unarm",
        "data": {16: 80, 25: 105, 35: 127, 50: 151, 70: 189, 95: 229, 120: 263,
                 150: 299, 185: 343, 240: 406, 300: 462, 400: 538}
    },
    ("EPR", "Al", "Three Core", "Air", "Armoured", "N/A"): {
        "source": "Table B.9 - EPR Al TC Air Arm",
        "data": {16: 81, 25: 105, 35: 127, 50: 153, 70: 190, 95: 230, 120: 264,
                 150: 300, 185: 343, 240: 402, 300: 459, 400: 530}
    },
}

# Total configurations: 
# Single Core: 4 tables (XLPE Cu, XLPE Al, EPR Cu, EPR Al) × 7 layouts × 1 unarmoured = 28
# Three Core: 4 tables × 3 installations × 2 armoured = 24
# TOTAL: 52 unarmoured configurations (armoured variants would double this)


# --- Correction Factors ---

# Table B.11: Ambient Ground Temperature (K1)
TABLE_B11 = {
    10: (1.10, 1.07),
    15: (1.05, 1.04),
    20: (1.00, 1.00),
    25: (0.95, 0.96),
    30: (0.89, 0.93),
    35: (0.84, 0.89),
    40: (0.77, 0.85),
    45: (0.71, 0.80),
    50: (0.63, 0.76),
    55: (0.55, 0.71),
    60: (0.45, 0.65)
}

# Table B.12 / B.13: Depth of Laying (K2)
TABLE_B12 = {
    0.5: (1.03, 1.05),
    0.6: (1.02, 1.03),
    0.8: (1.00, 1.00),
    1.0: (0.98, 0.97),
    1.25: (0.96, 0.95),
    1.5: (0.95, 0.93),
    1.75: (0.94, 0.91),
    2.0: (0.93, 0.90),
    2.5: (0.91, 0.88),
    3.0: (0.90, 0.86)
}

TABLE_B13 = {
    0.5: (1.03, 1.04),
    0.6: (1.02, 1.03),
    0.8: (1.00, 1.00),
    1.0: (0.98, 0.97),
    1.25: (0.96, 0.95),
    1.5: (0.95, 0.93),
    1.75: (0.94, 0.91),
    2.0: (0.93, 0.90),
    2.5: (0.92, 0.89),
    3.0: (0.91, 0.88)
}

# Table B.14 to B.17: Thermal Resistivity (K3)
# Complete tables from IEC 60502-2 standard
# Structure: {section_mm2: {resistivity_Km_W: correction_factor}}

# Table B.14: Direct buried single-core cables
TABLE_B14 = {
    16: {0.7: 1.29, 0.8: 1.24, 0.9: 1.19, 1.0: 1.15, 2.0: 0.89, 2.5: 0.82, 3.0: 0.75},
    25: {0.7: 1.30, 0.8: 1.25, 0.9: 1.20, 1.0: 1.16, 2.0: 0.89, 2.5: 0.81, 3.0: 0.75},
    35: {0.7: 1.30, 0.8: 1.25, 0.9: 1.21, 1.0: 1.16, 2.0: 0.89, 2.5: 0.81, 3.0: 0.75},
    50: {0.7: 1.32, 0.8: 1.26, 0.9: 1.21, 1.0: 1.16, 2.0: 0.89, 2.5: 0.81, 3.0: 0.74},
    70: {0.7: 1.33, 0.8: 1.27, 0.9: 1.22, 1.0: 1.17, 2.0: 0.89, 2.5: 0.81, 3.0: 0.74},
    95: {0.7: 1.34, 0.8: 1.28, 0.9: 1.22, 1.0: 1.18, 2.0: 0.89, 2.5: 0.80, 3.0: 0.74},
    120: {0.7: 1.34, 0.8: 1.28, 0.9: 1.22, 1.0: 1.18, 2.0: 0.88, 2.5: 0.80, 3.0: 0.74},
    150: {0.7: 1.35, 0.8: 1.28, 0.9: 1.23, 1.0: 1.18, 2.0: 0.88, 2.5: 0.80, 3.0: 0.74},
    185: {0.7: 1.35, 0.8: 1.29, 0.9: 1.23, 1.0: 1.18, 2.0: 0.88, 2.5: 0.80, 3.0: 0.74},
    240: {0.7: 1.36, 0.8: 1.29, 0.9: 1.23, 1.0: 1.18, 2.0: 0.88, 2.5: 0.80, 3.0: 0.73},
    300: {0.7: 1.36, 0.8: 1.30, 0.9: 1.24, 1.0: 1.19, 2.0: 0.88, 2.5: 0.80, 3.0: 0.73},
    400: {0.7: 1.37, 0.8: 1.30, 0.9: 1.24, 1.0: 1.19, 2.0: 0.88, 2.5: 0.79, 3.0: 0.73}
}

# Table B.15: Single-core cables in buried ducts
TABLE_B15 = {
    16: {0.7: 1.20, 0.8: 1.17, 0.9: 1.14, 1.0: 1.11, 2.0: 0.92, 2.5: 0.85, 3.0: 0.79},
    25: {0.7: 1.21, 0.8: 1.17, 0.9: 1.14, 1.0: 1.12, 2.0: 0.91, 2.5: 0.85, 3.0: 0.79},
    35: {0.7: 1.21, 0.8: 1.18, 0.9: 1.15, 1.0: 1.12, 2.0: 0.91, 2.5: 0.84, 3.0: 0.79},
    50: {0.7: 1.21, 0.8: 1.18, 0.9: 1.15, 1.0: 1.12, 2.0: 0.91, 2.5: 0.84, 3.0: 0.78},
    70: {0.7: 1.22, 0.8: 1.19, 0.9: 1.15, 1.0: 1.12, 2.0: 0.91, 2.5: 0.84, 3.0: 0.78},
    95: {0.7: 1.23, 0.8: 1.19, 0.9: 1.16, 1.0: 1.13, 2.0: 0.91, 2.5: 0.84, 3.0: 0.78},
    120: {0.7: 1.23, 0.8: 1.20, 0.9: 1.16, 1.0: 1.13, 2.0: 0.91, 2.5: 0.84, 3.0: 0.78},
    150: {0.7: 1.24, 0.8: 1.20, 0.9: 1.16, 1.0: 1.13, 2.0: 0.91, 2.5: 0.83, 3.0: 0.78},
    185: {0.7: 1.24, 0.8: 1.20, 0.9: 1.17, 1.0: 1.13, 2.0: 0.91, 2.5: 0.83, 3.0: 0.78},
    240: {0.7: 1.25, 0.8: 1.21, 0.9: 1.17, 1.0: 1.14, 2.0: 0.90, 2.5: 0.83, 3.0: 0.77},
    300: {0.7: 1.25, 0.8: 1.21, 0.9: 1.17, 1.0: 1.14, 2.0: 0.90, 2.5: 0.83, 3.0: 0.77},
    400: {0.7: 1.25, 0.8: 1.21, 0.9: 1.17, 1.0: 1.14, 2.0: 0.90, 2.5: 0.83, 3.0: 0.77}
}

# Table B.16: Direct buried three-core cables
TABLE_B16 = {
    16: {0.7: 1.23, 0.8: 1.19, 0.9: 1.16, 1.0: 1.13, 2.0: 0.91, 2.5: 0.84, 3.0: 0.78},
    25: {0.7: 1.24, 0.8: 1.20, 0.9: 1.16, 1.0: 1.13, 2.0: 0.91, 2.5: 0.84, 3.0: 0.78},
    35: {0.7: 1.25, 0.8: 1.21, 0.9: 1.17, 1.0: 1.13, 2.0: 0.91, 2.5: 0.83, 3.0: 0.78},
    50: {0.7: 1.25, 0.8: 1.21, 0.9: 1.17, 1.0: 1.14, 2.0: 0.91, 2.5: 0.83, 3.0: 0.77},
    70: {0.7: 1.26, 0.8: 1.21, 0.9: 1.18, 1.0: 1.14, 2.0: 0.90, 2.5: 0.83, 3.0: 0.77},
    95: {0.7: 1.26, 0.8: 1.22, 0.9: 1.18, 1.0: 1.14, 2.0: 0.90, 2.5: 0.83, 3.0: 0.77},
    120: {0.7: 1.26, 0.8: 1.22, 0.9: 1.18, 1.0: 1.14, 2.0: 0.90, 2.5: 0.83, 3.0: 0.77},
    150: {0.7: 1.27, 0.8: 1.22, 0.9: 1.18, 1.0: 1.15, 2.0: 0.90, 2.5: 0.83, 3.0: 0.77},
    185: {0.7: 1.27, 0.8: 1.23, 0.9: 1.18, 1.0: 1.15, 2.0: 0.90, 2.5: 0.83, 3.0: 0.77},
    240: {0.7: 1.28, 0.8: 1.23, 0.9: 1.19, 1.0: 1.15, 2.0: 0.90, 2.5: 0.83, 3.0: 0.77},
    300: {0.7: 1.28, 0.8: 1.23, 0.9: 1.19, 1.0: 1.15, 2.0: 0.90, 2.5: 0.82, 3.0: 0.77},
    400: {0.7: 1.28, 0.8: 1.23, 0.9: 1.19, 1.0: 1.15, 2.0: 0.90, 2.5: 0.82, 3.0: 0.76}
}

# Table B.17: Three-core cables in ducts
TABLE_B17 = {
    16: {0.7: 1.12, 0.8: 1.11, 0.9: 1.09, 1.0: 1.08, 2.0: 0.94, 2.5: 0.89, 3.0: 0.84},
    25: {0.7: 1.14, 0.8: 1.12, 0.9: 1.10, 1.0: 1.08, 2.0: 0.94, 2.5: 0.89, 3.0: 0.84},
    35: {0.7: 1.14, 0.8: 1.12, 0.9: 1.10, 1.0: 1.08, 2.0: 0.94, 2.5: 0.88, 3.0: 0.84},
    50: {0.7: 1.14, 0.8: 1.12, 0.9: 1.10, 1.0: 1.08, 2.0: 0.94, 2.5: 0.88, 3.0: 0.84},
    70: {0.7: 1.15, 0.8: 1.13, 0.9: 1.11, 1.0: 1.09, 2.0: 0.94, 2.5: 0.88, 3.0: 0.83},
    95: {0.7: 1.15, 0.8: 1.13, 0.9: 1.11, 1.0: 1.09, 2.0: 0.94, 2.5: 0.88, 3.0: 0.83},
    120: {0.7: 1.15, 0.8: 1.13, 0.9: 1.11, 1.0: 1.09, 2.0: 0.93, 2.5: 0.88, 3.0: 0.83},
    150: {0.7: 1.16, 0.8: 1.13, 0.9: 1.11, 1.0: 1.09, 2.0: 0.93, 2.5: 0.88, 3.0: 0.83},
    185: {0.7: 1.16, 0.8: 1.14, 0.9: 1.11, 1.0: 1.09, 2.0: 0.93, 2.5: 0.87, 3.0: 0.83},
    240: {0.7: 1.16, 0.8: 1.14, 0.9: 1.12, 1.0: 1.10, 2.0: 0.93, 2.5: 0.87, 3.0: 0.82},
    300: {0.7: 1.17, 0.8: 1.14, 0.9: 1.12, 1.0: 1.10, 2.0: 0.93, 2.5: 0.87, 3.0: 0.82},
    400: {0.7: 1.17, 0.8: 1.14, 0.9: 1.12, 1.0: 1.10, 2.0: 0.92, 2.5: 0.86, 3.0: 0.81}
}

# Table B.18 to B.21: Grouping (K4)
# Table B.18: Complete table for groups of three-core cables in horizontal formation
# laid direct in the ground - from IEC 60502-2
TABLE_B18_DATA = {
    2: {0: 0.80, 200: 0.86, 400: 0.90, 600: 0.92, 800: 0.94},
    3: {0: 0.69, 200: 0.77, 400: 0.82, 600: 0.86, 800: 0.89},
    4: {0: 0.62, 200: 0.72, 400: 0.79, 600: 0.83, 800: 0.87},
    5: {0: 0.57, 200: 0.68, 400: 0.76, 600: 0.81, 800: 0.85},
    6: {0: 0.54, 200: 0.65, 400: 0.74, 600: 0.80, 800: 0.84},
    7: {0: 0.51, 200: 0.63, 400: 0.72, 600: 0.78, 800: 0.83},
    8: {0: 0.49, 200: 0.61, 400: 0.71, 600: 0.78, 800: None},  # 800mm not defined in standard
    9: {0: 0.47, 200: 0.60, 400: 0.70, 600: 0.77, 800: None},
    10: {0: 0.46, 200: 0.59, 400: 0.69, 600: None, 800: None},
    11: {0: 0.45, 200: 0.57, 400: 0.69, 600: None, 800: None},
    12: {0: 0.43, 200: 0.56, 400: 0.68, 600: None, 800: None}
}

# Table B.19: Correction factors for groups of three-phase circuits 
# of single-core cables laid direct in the ground - from IEC 60502-2
TABLE_B19_DATA = {
    2: {0: 0.73, 200: 0.83, 400: 0.88, 600: 0.90, 800: 0.92},
    3: {0: 0.60, 200: 0.73, 400: 0.79, 600: 0.83, 800: 0.86},
    4: {0: 0.54, 200: 0.68, 400: 0.75, 600: 0.80, 800: 0.84},
    5: {0: 0.49, 200: 0.63, 400: 0.72, 600: 0.78, 800: 0.82},
    6: {0: 0.46, 200: 0.61, 400: 0.70, 600: 0.76, 800: 0.81},
    7: {0: 0.43, 200: 0.58, 400: 0.68, 600: 0.75, 800: 0.80},
    8: {0: 0.41, 200: 0.57, 400: 0.67, 600: 0.74, 800: None},
    9: {0: 0.39, 200: 0.55, 400: 0.66, 600: 0.73, 800: None},
    10: {0: 0.37, 200: 0.54, 400: 0.65, 600: None, 800: None},
    11: {0: 0.36, 200: 0.53, 400: 0.64, 600: None, 800: None},
    12: {0: 0.35, 200: 0.52, 400: 0.64, 600: None, 800: None}
}

# Table B.20: Correction factors for groups of three-core cables 
# in single way ducts in horizontal formation - from IEC 60502-2
TABLE_B20_DATA = {
    2: {0: 0.85, 200: 0.88, 400: 0.92, 600: 0.94, 800: 0.95},
    3: {0: 0.75, 200: 0.80, 400: 0.85, 600: 0.88, 800: 0.91},
    4: {0: 0.69, 200: 0.75, 400: 0.82, 600: 0.86, 800: 0.89},
    5: {0: 0.65, 200: 0.72, 400: 0.79, 600: 0.84, 800: 0.87},
    6: {0: 0.62, 200: 0.69, 400: 0.77, 600: 0.83, 800: 0.87},
    7: {0: 0.59, 200: 0.67, 400: 0.76, 600: 0.82, 800: 0.86},
    8: {0: 0.57, 200: 0.65, 400: 0.75, 600: 0.81, 800: None},
    9: {0: 0.55, 200: 0.64, 400: 0.74, 600: 0.80, 800: None},
    10: {0: 0.54, 200: 0.63, 400: 0.73, 600: None, 800: None},
    11: {0: 0.52, 200: 0.62, 400: 0.73, 600: None, 800: None},
    12: {0: 0.51, 200: 0.61, 400: 0.72, 600: None, 800: None}
}

# Table B.21: Correction factors for groups of three-phase circuits 
# of single-core cables in single-way ducts - from IEC 60502-2
TABLE_B21_DATA = {
    2: {0: 0.78, 200: 0.85, 400: 0.89, 600: 0.91, 800: 0.93},
    3: {0: 0.66, 200: 0.75, 400: 0.81, 600: 0.85, 800: 0.88},
    4: {0: 0.59, 200: 0.70, 400: 0.77, 600: 0.82, 800: 0.86},
    5: {0: 0.55, 200: 0.66, 400: 0.74, 600: 0.80, 800: 0.84},
    6: {0: 0.51, 200: 0.64, 400: 0.72, 600: 0.78, 800: 0.83},
    7: {0: 0.48, 200: 0.61, 400: 0.71, 600: 0.77, 800: 0.82},
    8: {0: 0.46, 200: 0.60, 400: 0.70, 600: 0.76, 800: None},
    9: {0: 0.44, 200: 0.58, 400: 0.69, 600: 0.76, 800: None},
    10: {0: 0.43, 200: 0.57, 400: 0.68, 600: None, 800: None},
    11: {0: 0.42, 200: 0.56, 400: 0.67, 600: None, 800: None},
    12: {0: 0.40, 200: 0.55, 400: 0.67, 600: None, 800: None}
}
